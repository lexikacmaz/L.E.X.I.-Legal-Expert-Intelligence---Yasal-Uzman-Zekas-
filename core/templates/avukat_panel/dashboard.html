{% extends 'base.html' %}

{% block content %}
<style>
    .panel-container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    
    /* İSTATİSTİK KARTLARI */
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 40px; }
    .card { 
        background: white; padding: 25px; border-radius: 10px; 
        box-shadow: 0 2px 10px rgba(0,0,0,0.05); text-align: center; 
        transition: 0.3s; 
    }
    .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    .card h3 { font-size: 2.5rem; margin: 10px 0; color: #333; }
    .card p { color: #666; margin: 0; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }

    /* TABLO TASARIMI */
    .table-box { background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); padding: 20px; margin-bottom: 40px; }
    .table-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #f4f4f4; padding-bottom: 10px; }
    
    table { width: 100%; border-collapse: collapse; }
    th { text-align: left; padding: 15px; background: #f8f9fa; color: #555; font-weight: 600; }
    td { padding: 15px; border-bottom: 1px solid #eee; color: #333; }
    tr:last-child td { border-bottom: none; }
    
    /* BUTON TASARIMLARI (DÜZELTİLDİ) */
    .btn-action {
        display: inline-block;
        background-color: #007bff; /* MAVİ VE NET */
        color: white;
        padding: 8px 15px;
        border-radius: 5px;
        text-decoration: none;
        font-weight: bold;
        font-size: 0.85rem;
        transition: 0.2s;
        box-shadow: 0 2px 5px rgba(0,123,255,0.3);
    }
    .btn-action:hover { background-color: #0056b3; transform: translateY(-2px); }

    /* DURUM ETİKETLERİ */
    .badge { padding: 5px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: bold; }
    .badge-bekliyor { background: #fff3cd; color: #856404; }
    .badge-tamam { background: #d4edda; color: #155724; }
    .badge-iptal { background: #f8d7da; color: #721c24; }
</style>

<div class="panel-container">
    
    <h2 style="margin-bottom: 30px; color: #2c3e50;">Avukat Yönetim Paneli</h2>

    <div class="grid">
        <div class="card" style="border-top: 4px solid #007bff;">
            <h3>{{ istatistik.toplam }}</h3>
            <p>Toplam İş</p>
        </div>
        <div class="card" style="border-top: 4px solid #ffc107;">
            <h3>{{ istatistik.bekleyen }}</h3>
            <p>Bekleyen</p>
        </div>
        <div class="card" style="border-top: 4px solid #28a745;">
            <h3>{{ istatistik.tamamlanan }}</h3>
            <p>Tamamlanan</p>
        </div>
        <div class="card" style="border-top: 4px solid #dc3545;">
            <h3>{{ istatistik.iptal }}</h3>
            <p>İptal</p>
        </div>
    </div>

    <div class="table-box">
        <div class="table-header">
            <h3 style="margin: 0; color: #d39e00;">⏳ Bekleyen Randevular</h3>
        </div>
        
        {% if bekleyenler %}
        <table>
            <thead>
                <tr>
                    <th>Müşteri</th>
                    <th>Telefon</th>
                    <th>Konu</th>
                    <th>Tarih</th>
                    <th>İşlem</th>
                </tr>
            </thead>
            <tbody>
                {% for randevu in bekleyenler %}
                <tr>
                    <td><strong>{{ randevu.ad_soyad }}</strong></td>
                    <td>{{ randevu.telefon }}</td>
                    <td>{{ randevu.mesaj|truncatechars:30 }}</td>
                    <td>{{ randevu.tarih|date:"d M Y H:i" }}</td>
                    <td>
                        <a href="{% url 'avukat_randevu_islem' randevu.id %}" class="btn-action">
                            ⚡ İşlemi Başlat
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
            <p style="padding: 20px; text-align: center; color: #999;">Bekleyen yeni iş yok, kahveni içebilirsin. ☕</p>
        {% endif %}
    </div>

    <div class="table-box">
        <div class="table-header">
            <h3 style="margin: 0; color: #28a745;">✅ Geçmiş İşlemler</h3>
        </div>
        
        {% if gecmis %}
        <table>
            <thead>
                <tr>
                    <th>Müşteri</th>
                    <th>Konu</th>
                    <th>Sonuç Durumu</th>
                    <th>Tarih</th>
                    <th>Detay</th>
                </tr>
            </thead>
            <tbody>
                {% for islem in gecmis %}
                <tr>
                    <td>{{ islem.ad_soyad }}</td>
                    <td>{{ islem.mesaj|truncatechars:30 }}</td>
                    <td>
                        {% if islem.durum == 'Tamamlandı' %}
                            <span class="badge badge-tamam">Başarılı</span>
                        {% else %}
                            <span class="badge badge-iptal">{{ islem.durum }}</span>
                        {% endif %}
                    </td>
                    <td>{{ islem.tarih|date:"d M Y" }}</td>
                    <td>
                        <a href="{% url 'avukat_randevu_islem' islem.id %}" style="color: #666; font-size: 0.9rem;">Görüntüle</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
            <p style="padding: 20px; text-align: center; color: #999;">Henüz tamamlanmış bir iş yok.</p>
        {% endif %}
    </div>

</div>
{% endblock %}